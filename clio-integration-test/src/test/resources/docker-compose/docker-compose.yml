version: '2'

services:
  clio-integration-test:
    image: broadinstitute/clio-integration-test:${CLIO_DOCKER_TAG}
    environment:
      CLIO_HTTP_HOST: clio-server
      ELASTICSEARCH_HTTP_HOST: elasticsearch1
  clio-server:
    image: broadinstitute/clio-server:${CLIO_DOCKER_TAG}
    environment:
      clio.server.elasticsearch.http-hosts.0.hostname: elasticsearch1
  elasticsearch1:
    extends:
      file: elasticsearch-compose.yml
      service: elasticsearch
    volumes:
      - esdata1:/usr/share/elasticsearch/data
  elasticsearch2:
    extends:
      file: elasticsearch-compose.yml
      service: elasticsearch
    volumes:
      - esdata2:/usr/share/elasticsearch/data
    environment:
        discovery.zen.ping.unicast.hosts: elasticsearch1

volumes:
  esdata1:
    driver: local
  esdata2:
    driver: local
